#include "ModelRenderComponent.h"

////////////////////////////////////////////////////////////////////////////
// コンストラクタ
////////////////////////////////////////////////////////////////////////////
ModelRenderComponent::ModelRenderComponent(GameObject* pOwner, const std::string& tagName)
    : IComponent(pOwner,tagName){
    // モデルの初期化
    model_ = std::make_unique<Model>("DefaultAssets/cube.obj");
    model_->parentMat_ = owner_->GetWorldMatPtr();
    model_->UpdateMatrix();
}

////////////////////////////////////////////////////////////////////////////
// 初期化
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::Initialize(const std::string& modelPath){
    // モデルの初期化
    model_ = std::make_unique<Model>(modelPath);
    model_->parentMat_ = owner_->GetWorldMatPtr();
    model_->UpdateMatrix();
}

////////////////////////////////////////////////////////////////////////////
// フレーム開始時の処理
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::BeginFrame(){
}

////////////////////////////////////////////////////////////////////////////
// 更新処理
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::Update(){
    model_->Update();
}

////////////////////////////////////////////////////////////////////////////
// 描画処理
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::Draw(){
    model_->Draw();
}

////////////////////////////////////////////////////////////////////////////
// フレーム終了時の処理
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::EndFrame(){
}


/////////////////////////////////////////////////////////////////////////////
// 終了処理
/////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::Finalize(){
}

////////////////////////////////////////////////////////////////////////////
// Modelの切り替え
////////////////////////////////////////////////////////////////////////////
void ModelRenderComponent::ChangeModel(const std::string& modelFilePath){
    Transform transform = model_->transform_;
    model_ = std::make_unique<Model>(modelFilePath);
    model_->parentMat_ = owner_->GetWorldMatPtr();
    model_->transform_ = transform;
    model_->UpdateMatrix();
}
