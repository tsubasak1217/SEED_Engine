#include <Game/Scene/Scene_Game/Scene_Game.h>
#include <SEED/Source/SEED.h>
#include <Environment/Environment.h>
#include <SEED/Source/Manager/ParticleManager/CPUParticle/ParticleManager.h>
#include <SEED/Source/Manager/CameraManager/CameraManager.h>
#include <SEED/Source/Manager/AudioManager/AudioManager.h>

// scene
#include <Game/Scene/Scene_Clear/Scene_Clear.h>

// state
#include <Game/Scene/Scene_Game/State/GameState_Play.h>
#include <Game/Scene/Scene_Game/State/GameState_Select.h>

/////////////////////////////////////////////////////////////////////////////////////////
//
//  コンストラクタ・デストラクタ
//
/////////////////////////////////////////////////////////////////////////////////////////

Scene_Game::Scene_Game() : Scene_Base(){
};

Scene_Game::~Scene_Game(){
    Scene_Base::Finalize();

    // カメラのリセット
   SEED::Instance::RemoveCamera("gameCamera");
   SEED::Instance::SetMainCamera("default");
}

/////////////////////////////////////////////////////////////////////////////////////////
//
//  初期化
//
/////////////////////////////////////////////////////////////////////////////////////////

void Scene_Game::Initialize(){

    // 共通初期化
    Scene_Base::Initialize();

    // チュートリアルプレイ選択に応じてステートを変更
    if(isPlayTutorial_){
        // チュートリアル楽曲データの読み込み
        SongInfo data;
        data.Initialize("toritsuTutorialJHS");
        Scene_Clear::SetJacketPath(
            "Resources/NoteDatas/" + data.folderName + "/" + data.folderName + ".png"
        );

        // ステート初期化
        ChangeState(new GameState_Play(this,data,0));
        isPlayTutorial_ = false;

    } else{
        // ステート初期化
        ChangeState(new GameState_Select(this));
    }
}

void Scene_Game::Finalize() {
    Scene_Base::Finalize();
}

/////////////////////////////////////////////////////////////////////////////////////////
//
//  更新処理
//
/////////////////////////////////////////////////////////////////////////////////////////

void Scene_Game::Update(){
    Scene_Base::Update();
}

/////////////////////////////////////////////////////////////////////////////////////////
//
//  描画処理
//
/////////////////////////////////////////////////////////////////////////////////////////

void Scene_Game::Draw(){

    // 共通描画
    Scene_Base::Draw();

}

/////////////////////////////////////////////////////////////////////////////////////////
//
//  フレーム開始時の処理
//
/////////////////////////////////////////////////////////////////////////////////////////
void Scene_Game::BeginFrame(){
    Scene_Base::BeginFrame();
}


/////////////////////////////////////////////////////////////////////////////////////////
//
//  フレーム終了時の処理
//
/////////////////////////////////////////////////////////////////////////////////////////
void Scene_Game::EndFrame(){
    Scene_Base::EndFrame();
}


/////////////////////////////////////////////////////////////////////////////////////////
//
//  すべてのコライダーをコリジョンマネージャに渡す
//
/////////////////////////////////////////////////////////////////////////////////////////
void Scene_Game::HandOverColliders(){
    Scene_Base::HandOverColliders();
}